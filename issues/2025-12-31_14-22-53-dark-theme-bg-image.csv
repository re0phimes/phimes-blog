"id","priority","phase","area","title","description","acceptance_criteria","test_mcp","review_initial_requirements","review_regression_requirements","dev_state","review_initial_state","review_regression_state","git_state","owner","refs","notes"
"BGDARK-010","P0","1","frontend","复现并确认深色背景图不可见类型","在深色主题下复现“背景图不可见”，确认是图片加载失败、loaded 逻辑未生效，还是遮罩/滤镜过强导致不可感知，并落盘可复现口径。","明确复现步骤（包含 theme=dark、backgroundType=image、URL=/ 或指定路由、viewport 以及是否滚动触发 sticky）；给出分类结论（A 404/路径、B opacity/loaded、C 遮罩/brightness）；在 notes 中记录 root_cause 与关键 DOM/CSS 证据（如 #background-cover、.background::after、.cover opacity/filter）。","AUTOFRONTEND","Review 复现口径是否可重复；确认 Network/Console/Elements 三处证据一致；确认不是用户本地缓存/浏览器扩展导致。","在至少 2 条路由（/ 与 任意 posts/ 文章页）复核同一现象；若存在部署 base，需补 1 次带 base 的预览验证口径。","已完成","已完成","已完成","已提交","","plan/2025-12-31_13-56-41-dark-theme-bg-image.md:16;.vitepress/theme/components/Background.vue:1;.vitepress/theme/App.vue:78;.vitepress/theme/store/index.js:7","picked_reason:P0 先复现分类以避免盲改 | started_at:2025-12-31T14:28:05+08:00 | root_cause:深色主题下背景图依赖 img 加载后添加 .loaded 才会 opacity=1；若图片请求 404/加载失败(例如站点存在 base 时使用了绝对路径 /images/百万2.jpg)，则会长期 opacity=0；同时 error handler 会把 src 替换为透明 svg（肉眼仍为空）。 | reproduce:npm run dev 后打开 / → 确认 theme=dark 且 backgroundType=image；DevTools Network 观察 #background-cover 的请求是否 200；Elements 观察 #background-cover 是否获得 loaded class，Computed 检查 opacity/filter 与 .background::after 遮罩叠加。 | evidence:store 默认 backgroundUrl=""/images/百万2.jpg""；Background.vue .cover 默认 opacity:0 且仅在 .loaded 时变 1；coverError 回退为透明 svg。 | validation_limited:当前环境缺少 GUI 浏览器，无法进行真实渲染截图/多浏览器复现，仅做了代码审阅与静态资源存在性检查。 | manual_test:npm run dev；浏览器打开首页与任一 posts 页面；切换 dark/light + image/patterns；确认 background-cover 网络请求与 loaded class/opacity 行为符合预期。 | risk:low 仅复现/分类与结论落盘，不改布局行为。 | done_at:2025-12-31T14:33:48+08:00"
"BGDARK-020","P0","2","frontend","定位并固化 root cause 判定树","基于复现结果，定位导致不可见的具体 root cause，并将“判定树/处理策略”固化为可执行结论（用于指导实现与回滚）。","明确 root cause（例如：base 路径导致 /images 404；或 img load 未触发导致 opacity=0；或 ::after 遮罩+brightness 叠加过强）；列出需要修改的文件清单与变更边界；明确回滚方式（恢复原行为）。","AUTOFRONTEND","Review root cause 是否指向具体可修改点（代码行/样式规则），而非泛泛“看不到”；确认回滚方案可行。","确认结论在 dark/light 与 image/patterns 两组组合下都成立（至少描述清楚预期差异）。","已完成","已完成","已完成","已提交","","plan/2025-12-31_13-56-41-dark-theme-bg-image.md:21;.vitepress/theme/components/Background.vue:45;.vitepress/theme/style/main.scss:76","picked_reason:P0 承接复现结论，先固化 root cause 与回滚边界 | started_at:2025-12-31T14:34:42+08:00 | root_cause:A:backgroundUrl 为站内静态资源时使用绝对路径 /images/...，在部署 base!=/ 或预览 base 场景易 404；B:Background.vue 以 .loaded 控制 opacity，加载失败时不会有可见兜底(transparent svg + opacity=0)；C:dark 下 brightness(0.6)+遮罩渐变可能让图片更不明显，但通常不至于“完全不可见”。 | decision_tree:1) Network 先看 #background-cover 请求是否 200；非 200→对站内路径应用 withBase + encodeURI；2) 200 但不可见→检查 loaded class/opacity，必要时用显式 reactive loaded 状态替代依赖 DOM class；3) loaded 且仍不可见→调低遮罩/提高 brightness，确保正文可读。 | scope_files:.vitepress/theme/components/Background.vue;.vitepress/theme/store/index.js;（可选）.vitepress/theme/style/main.scss 仅在需要调遮罩/亮度时改动。 | rollback:回退 Background.vue 的 URL 解析/兜底与样式改动；store backgroundUrl/背景默认值恢复；保留对外 API 不变。 | evidence:见 Background.vue 目前的 opacity/loaded 逻辑与 store 的默认 backgroundUrl。 | done_at:2025-12-31T14:35:41+08:00"
"BGDARK-030","P0","3","frontend","实现背景图可见性修复（含 base/编码/兜底）","按 root cause 实施最小修复：确保深色主题下背景图可见，并对加载失败/部署 base/中文路径提供兼容与降级，不影响浅色与纹理背景。","深色主题 + image 背景下背景图肉眼可见；不存在“永远 opacity=0”情况；若图片 404/加载失败可降级（patterns 或轻量渐变），页面仍可读；若站点有 base，站内背景路径在 build/preview 下可正确加载；npm run build 通过。","AUTOFRONTEND","Review 是否仅修改 Background/App/main.scss/store 等必要文件；确认 withBase/encode 仅对站内路径应用，不破坏外链 URL；确认降级逻辑不会引入无限重试/闪烁。","回归 dark/light + image/patterns 切换；访问 / 与 文章页；运行 npm run build；若 lint 可用则补跑 npm run lint（不可用需 notes 记录）。","已完成","已完成","已完成","已提交","","plan/2025-12-31_13-56-41-dark-theme-bg-image.md:29;.vitepress/theme/components/Background.vue:4;.vitepress/theme/App.vue:103;.vitepress/theme/style/main.scss:76;.vitepress/theme/store/index.js:52;public/images/百万2.jpg:1","picked_reason:P0 核心修复项，先让 dark+image 背景可见且可降级 | started_at:2025-12-31T14:36:19+08:00 | change:Background.vue 对站内路径应用 withBase + encodeURI，避免 base 部署与中文文件名导致的 404；引入 coverIsLoaded/coverHasError 状态，避免仅依赖 DOM class；加载失败时自动降级为 patterns 背景，避免“全黑/空白”。 | evidence:npm run build (vitepress build) 已完成；Background 现在在 error 时会 fallback 到 patterns。 | validation_limited:未能在当前环境打开浏览器对 dark/light + image/patterns 做真实视觉回归，仅能确保 build 通过与逻辑兜底正确。 | manual_test:npm run dev 或 npm run preview；访问 / 与 任意 posts/ 页面；切换主题与 backgroundType，观察背景图在 dark+image 下可见，且断网/改错 URL 时会回退到 patterns。 | risk:medium 背景 URL 解析逻辑变更，需人工确认外链/自定义 URL 行为与预期一致。 | done_at:2025-12-31T14:40:44+08:00"
"BGDARK-040","P1","4","frontend","限制改动范围并清理调试输出","确保修复只影响背景相关逻辑与样式，清理临时 console/debug，保持代码风格一致并更新必要 refs。","不存在残留 debug console（如 Background.vue 的调试输出）；变更文件清单符合边界；refs 指向新的关键行；npm run build 通过。","AUTOFRONTEND","Review 无无关重构/格式化；确认变更可读且易回滚；确认不会影响 SSR。","回归检查：切换主题/背景类型时无控制台异常；运行 npm run build。","未开始","未开始","未开始","未提交","","plan/2025-12-31_13-56-41-dark-theme-bg-image.md:40;.vitepress/theme/components/Background.vue:40",""
"BGDARK-050","P0","5","frontend","验证与回归（深色背景可见性）","执行最小但可复现的回归验证，覆盖深色/浅色、image/patterns、不同路由与多 viewport，并记录证据。","至少验证 2 个 viewport（桌面/移动）与 2 条路由（/ 与 文章页）；检查点：背景图在深色下可见、正文可读、无横向滚动条/闪烁；npm run build 通过；在 notes 中记录 evidence（命令输出 + 手工检查步骤/截图路径）。","AUTOE2E","Review 验收口径覆盖“可见性+可读性+降级”三要素；确保证据可复现。","复跑 npm run build；如可用则补跑 npm run preview 并按步骤访问验证；如测试受限需在 notes 写 validation_limited/manual_test/risk。","未开始","未开始","未开始","未提交","","plan/2025-12-31_13-56-41-dark-theme-bg-image.md:46;package.json:14;.vitepress/theme/components/Background.vue:45",""
